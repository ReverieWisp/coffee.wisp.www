<!DOCTYPE html>
<html>
	<head>
		<!-- Page config -->
		<meta charset="UTF-8">
		<title>Revere Wisp</title>
		<meta name="description" content="coffee for wisp pls">
		<meta name="author" content="Reverie Wisp">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Links -->
		<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="style.css">
		<link rel="icon" href="favicon.ico" type="image/gif" sizes="32x32">
	</head>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<!-- I added this out of curiosity. -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-86495827-2"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-86495827-2');
	</script>


	<body class="rw-content">
		<div class="rw-wisp">
			<img id="wisp" src="wisp.png" alt="a tired dragon holding coffee" onclick="javascript:wispBoop()">
		</div>
		<div class="rw-footer">
			<span id="flips"></span>Site by <a style="text-decoration: none;" href="https://www.reveriewisp.com/">Reverie Wisp</a>, art by <a href="http://askdrakomod.tumblr.com">Drako</a>
		</div>
	</body>


	<script type="text/javascript">
	// Initialize variables. Grap flips from memory if necessary.
	var targetHeight = 0;
	var baseRotation = 0;
	var rotationMod = 0;
	var flipCount = 0;
	var flipCountStart = parseInt(sessionStorage.getItem('wisp-flips'));
	if(!flipCountStart)
		flipCountStart = 0;
	else 
		flipCount = flipCountStart;

	// Resize
	wispResize();

	// Add resize listener
	window.addEventListener("resize", wispResize);

	// Resizes wisp to be at the correct height, and at the correct location too.
	function wispResize() {
		targetHeight = window.innerHeight
			|| document.documentElement.clientHeight
			|| document.body.clientHeight;

		document.getElementById("wisp").style.maxHeight = Math.round(targetHeight * .8) + "px";
		document.getElementById("wisp").style.transform = "rotate(" + (baseRotation + Math.sin(Date.now() / 1220) * 4) + "deg)";
	}
	
	// Spin it to win it!
	function wispBoop() {
		rotationMod += 20;
		flipCount += 1;
		if(flipCount > flipCountStart) {
			document.getElementById("flips").innerHTML = "(flips: " + flipCount + ") ";
			sessionStorage.setItem('wisp-flips', flipCount);
		}
	}

	// Every 5ms, update the sway of wisp.
	setInterval(function() {
		if(rotationMod > 0) {
			rotationMod *= .9;
			baseRotation += rotationMod;
		}

		wispResize();
	}, 5);
	</script>
</html>